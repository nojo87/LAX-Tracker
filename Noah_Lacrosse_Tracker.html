<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Noah's College Lacrosse Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    th { background-color: #f2f2f2; }
    select, input { width: 100%; }
    .btn { margin-top: 1rem; padding: 0.5rem 1rem; font-weight: bold; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Noah's College Lacrosse Tracker</h2>
  <form id="trackerForm">
    <table>
      <thead>
        <tr>
          <th>University</th>
          <th>Coach Name</th>
          <th>Title</th>
          <th>Contact Method</th>
          <th>Contact Location</th>
          <th>Last Contact Date</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Level</th>
          <th>Program Tier</th>
          <th>Region</th>
          <th>Major Fit</th>
          <th>Population</th>
          <th>Visit Planned?</th>
          <th>Visit Date</th>
          <th>Interest (1‚Äì10)</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody id="trackerBody"></tbody>
    </table>
    <button type="button" class="btn" onclick="addRow()">+ Add Row</button>
    <button type="button" class="btn" onclick="saveToLocal()">üíæ Save</button>
    <button type="button" class="btn" onclick="exportToCSV()">‚¨áÔ∏è Export to Excel</button>
    <button type="button" class="btn" onclick="window.print()">üñ®Ô∏è Export to PDF</button>
  </form>

  <script>
    const dropdownOptions = {
      contactMethod: ["Email", "Phone Call", "Text", "DM", "In-Person", "Zoom", "IMLCA Site"],
      level: ["D1", "D2", "D3", "MCLA", "Club"],
      programTier: ["Upper Tier", "Moderate", "Mediocre"],
      region: ["West", "Mid", "East", "South"],
      majorFit: ["Good", "Average", "Poor"],
      population: ["<5k", "6-15k", "16-30k", "30k+"],
      visitPlanned: ["Yes", "No"]
    };

    function createDropdown(options) {
      const select = document.createElement('select');
      options.forEach(option => {
        const opt = document.createElement('option');
        opt.value = option;
        opt.textContent = option;
        select.appendChild(opt);
      });
      return select;
    }

    function addRow(data = {}) {
      const tbody = document.getElementById('trackerBody');
      const row = document.createElement('tr');

      const fields = [
        'university', 'coachName', 'title', 'contactMethod', 'contactLocation', 'lastContactDate',
        'phone', 'email', 'level', 'programTier', 'region', 'majorFit', 'population',
        'visitPlanned', 'visitDate', 'interest', 'notes'
      ];

      fields.forEach(field => {
        const cell = document.createElement('td');
        let input;
        if (field in dropdownOptions) {
          input = createDropdown(dropdownOptions[field]);
        } else if (field.includes('Date')) {
          input = document.createElement('input');
          input.type = 'date';
        } else if (field === 'interest') {
          input = document.createElement('input');
          input.type = 'number';
          input.min = 1;
          input.max = 10;
        } else {
          input = document.createElement('input');
          input.type = field === 'email' ? 'email' : 'text';
        }
        input.value = data[field] || '';
        cell.appendChild(input);
        row.appendChild(cell);
      });

      tbody.appendChild(row);
    }

    function saveToLocal() {
      const rows = Array.from(document.querySelectorAll('#trackerBody tr'));
      const data = rows.map(row => {
        const cells = row.querySelectorAll('td');
        return {
          university: cells[0].querySelector('input').value,
          coachName: cells[1].querySelector('input').value,
          title: cells[2].querySelector('input').value,
          contactMethod: cells[3].querySelector('select').value,
          contactLocation: cells[4].querySelector('input').value,
          lastContactDate: cells[5].querySelector('input').value,
          phone: cells[6].querySelector('input').value,
          email: cells[7].querySelector('input').value,
          level: cells[8].querySelector('select').value,
          programTier: cells[9].querySelector('select').value,
          region: cells[10].querySelector('select').value,
          majorFit: cells[11].querySelector('select').value,
          population: cells[12].querySelector('select').value,
          visitPlanned: cells[13].querySelector('select').value,
          visitDate: cells[14].querySelector('input').value,
          interest: cells[15].querySelector('input').value,
          notes: cells[16].querySelector('input').value
        }
      });
      localStorage.setItem('lacrosseTracker', JSON.stringify(data));
      alert('Saved to local storage!');
    }

    function loadFromLocal() {
      const data = JSON.parse(localStorage.getItem('lacrosseTracker') || '[]');
      data.forEach(entry => addRow(entry));
    }

    function exportToCSV() {
      const headers = Array.from(document.querySelectorAll('thead th')).map(th => th.textContent);
      const rows = Array.from(document.querySelectorAll('#trackerBody tr')).map(row =>
        Array.from(row.querySelectorAll('input, select')).map(cell => cell.value)
      );
      let csvContent = [headers.join(',')].concat(rows.map(r => r.join(','))).join('\n');
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.setAttribute('href', url);
      link.setAttribute('download', 'Noah_Lacrosse_Tracker.csv');
      link.style.display = 'none';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    loadFromLocal();
    if (document.getElementById('trackerBody').rows.length === 0) addRow();
  </script>
</body>
</html>
